{"ast":null,"code":"import { SolicitudDTO } from 'src/app/models/Solicitud';\nimport Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/generic-service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/shared/services/notificaciones.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../shared/navbar/navbar.component\";\n\nfunction SolicitudComponent_ul_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\")(1, \"li\")(2, \"b\");\n    i0.ɵɵtext(3, \"Nombres:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"li\")(6, \"b\");\n    i0.ɵɵtext(7, \"Nivel:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"li\")(10, \"b\");\n    i0.ɵɵtext(11, \"Instituci\\u00F3n: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.estudiante.nombres, \" \", ctx_r0.estudiante.apellidos, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.estudiante.nivel.nombre, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.estudiante.institucion.nombre);\n  }\n}\n\nfunction SolicitudComponent_li_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\")(1, \"div\", 15)(2, \"i\", 16);\n    i0.ɵɵtext(3, \"file_copy\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 17)(7, \"div\", 2)(8, \"ul\")(9, \"li\")(10, \"b\");\n    i0.ɵɵtext(11, \"Descripci\\u00F3n:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementStart(13, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function SolicitudComponent_li_18_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const documento_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.agregarASolicitud(documento_r4));\n    });\n    i0.ɵɵelementStart(14, \"i\", 16);\n    i0.ɵɵtext(15, \"add\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"li\")(17, \"b\");\n    i0.ɵɵtext(18, \" Nivel:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const documento_r4 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\"\", documento_r4.nombre, \" de la institucion \", documento_r4.institucion.nombre, \"\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\" \", documento_r4.descripcion, \" \");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate1(\" \", documento_r4.nivel.nombre, \" \");\n  }\n}\n\nfunction SolicitudComponent_h6_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h6\");\n    i0.ɵɵtext(1, \"No hay documentos disponibles\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SolicitudComponent_tbody_42_tr_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function SolicitudComponent_tbody_42_tr_1_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const documentoSeleccionado_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.removerDocumento(documentoSeleccionado_r8));\n    });\n    i0.ɵɵelementStart(11, \"i\", 16);\n    i0.ɵɵtext(12, \"delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const documentoSeleccionado_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(documentoSeleccionado_r8.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(documentoSeleccionado_r8.descripcion);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(documentoSeleccionado_r8.nivel.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(documentoSeleccionado_r8.institucion.nombre);\n  }\n}\n\nfunction SolicitudComponent_tbody_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tbody\");\n    i0.ɵɵtemplate(1, SolicitudComponent_tbody_42_tr_1_Template, 13, 4, \"tr\", 11);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.documentosSeleccionados);\n  }\n}\n\nconst _c0 = function () {\n  return [\"/historial\"];\n};\n\nexport let SolicitudComponent = /*#__PURE__*/(() => {\n  class SolicitudComponent {\n    constructor(genericService, _router, notificacionService) {\n      this.genericService = genericService;\n      this._router = _router;\n      this.notificacionService = notificacionService;\n      this.pagename = \"Nueva solicitud\";\n      this.componentUrl = \"solicitud/\";\n      this.estudianteUrl = \"estudiante/\";\n      this.documentoUrl = \"documento/\";\n      this.matricula = localStorage.getItem('matricula');\n      this.editMode = false;\n      this.documentosSeleccionados = [];\n    }\n\n    ngOnInit() {\n      this.validarLogin();\n      this.getEstudiante();\n      this.getDocumentos();\n      this.jquery_code();\n      this.notificacionService.userConnected().subscribe(data => {\n        console.log('something', data);\n      });\n    }\n\n    validarLogin() {\n      if (localStorage.length === 0) {\n        Swal.fire({\n          title: 'No estás logeado!',\n          icon: \"error\",\n          showCloseButton: true\n        }).then(result => {\n          this._router.navigate(['/']);\n        });\n      }\n    }\n\n    jquery_code() {\n      $(document).ready(function () {\n        $('.collapsible').collapsible();\n      });\n    }\n\n    getEstudiante() {\n      this.genericService.getByMat(this.estudianteUrl + \"bymat/\", this.matricula, estudiante => {\n        this.estudiante = estudiante;\n        this.editMode = false;\n      });\n    }\n\n    getDocumentos() {\n      let data = {\n        institucionId: localStorage.getItem('institucionId'),\n        nivelId: localStorage.getItem('nivelId')\n      };\n      this.genericService.getEstudianteDocs(this.documentoUrl + \"withparam/estudiante\", data, documentos => {\n        if (documentos.length < 1) {\n          this.documentos = null;\n        } else {\n          this.documentos = documentos;\n        }\n      });\n    }\n\n    getSolicitudes() {\n      this.genericService.getAll(this.componentUrl, solicitudes => {\n        this.solicitudes = solicitudes;\n      });\n    }\n\n    agregarASolicitud(documento) {\n      this.documentosSeleccionados.push(documento);\n      console.log(this.documentosSeleccionados);\n    }\n\n    removerDocumento(documento) {\n      let index = this.documentosSeleccionados.indexOf(documento);\n      this.documentosSeleccionados.splice(index, 1);\n    }\n\n    enviarSolicitud(estudianteId, documentosSeleccionados) {\n      if (documentosSeleccionados.length > 0) {\n        let solicitud = new SolicitudDTO(estudianteId, documentosSeleccionados);\n        this.genericService.crear(this.componentUrl, solicitud, solicitud => {\n          this.documentosSeleccionados = [];\n          this.notificacionService.notificar('solicitud-creada', {\n            code: solicitud.solicitudCode,\n            id: solicitud.id\n          });\n        });\n      } else {\n        Swal.fire(\"Error\", \"No se puede enviar una solicitud vacia, por favor seleccione los documentos que desea solicitar\", \"error\");\n      }\n    }\n\n  }\n\n  SolicitudComponent.ɵfac = function SolicitudComponent_Factory(t) {\n    return new (t || SolicitudComponent)(i0.ɵɵdirectiveInject(i1.GenericService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.NotificacionesService));\n  };\n\n  SolicitudComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SolicitudComponent,\n    selectors: [[\"app-solicitud\"]],\n    decls: 43,\n    vars: 7,\n    consts: [[3, \"pagename\"], [1, \"container\"], [1, \"row\"], [1, \"col\", \"s12\", \"l4\"], [1, \"card\"], [1, \"card-content\"], [4, \"ngIf\"], [1, \"card-action\"], [1, \"btn\", \"light-blue\", 2, \"width\", \"100%\", 3, \"routerLink\"], [1, \"col\", \"s12\", \"l8\"], [1, \"collapsible\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"light-blue\", \"right\", 3, \"click\"], [1, \"material-icons\", \"right\"], [1, \"col\", \"m12\"], [1, \"collapsible-header\"], [1, \"material-icons\"], [1, \"collapsible-body\"], [1, \"btn-floating\", \"btn-small\", \"blue\", \"right\", 3, \"click\"], [1, \"btn\", \"btn-small\", \"waves-effect\", \"waves-light\", \"light-blue\", \"right\", 3, \"click\"]],\n    template: function SolicitudComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-navbar\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h5\");\n        i0.ɵɵtext(6, \"Tu informaci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 5);\n        i0.ɵɵtemplate(8, SolicitudComponent_ul_8_Template, 13, 4, \"ul\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 7)(10, \"button\", 8);\n        i0.ɵɵtext(11, \"Ver mis solicitudes\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(12, \"div\", 9)(13, \"div\", 4)(14, \"h5\");\n        i0.ɵɵtext(15, \"Documentos disponibles\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 5)(17, \"ul\", 10);\n        i0.ɵɵtemplate(18, SolicitudComponent_li_18_Template, 20, 4, \"li\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, SolicitudComponent_h6_19_Template, 2, 0, \"h6\", 6);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(20, \"div\", 2)(21, \"h5\");\n        i0.ɵɵtext(22, \"Documentos a solicitar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function SolicitudComponent_Template_button_click_23_listener() {\n          return ctx.enviarSolicitud(ctx.estudiante.id, ctx.documentosSeleccionados);\n        });\n        i0.ɵɵtext(24, \"Enviar\");\n        i0.ɵɵelementStart(25, \"i\", 13);\n        i0.ɵɵtext(26, \"send\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(27, \"div\", 2)(28, \"div\", 14)(29, \"table\")(30, \"thead\")(31, \"tr\")(32, \"th\");\n        i0.ɵɵtext(33, \"Nombre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"th\");\n        i0.ɵɵtext(35, \"Descripci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"th\");\n        i0.ɵɵtext(37, \"Nivel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"th\");\n        i0.ɵɵtext(39, \"Instituci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"th\");\n        i0.ɵɵtext(41, \"Opciones\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(42, SolicitudComponent_tbody_42_Template, 2, 1, \"tbody\", 6);\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"pagename\", ctx.pagename);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.estudiante);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(6, _c0));\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngForOf\", ctx.documentos);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.documentos);\n        i0.ɵɵadvance(23);\n        i0.ɵɵproperty(\"ngIf\", ctx.documentosSeleccionados);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i2.RouterLink, i5.NavbarComponent],\n    styles: [\".container[_ngcontent-%COMP%]{padding-top:40px}h5[_ngcontent-%COMP%]{padding-left:10px;padding-top:15px}.card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:15px}\"]\n  });\n  return SolicitudComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}